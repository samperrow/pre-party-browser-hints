/* Flying Pages | (c) gijo-varghese https://github.com/gijo-varghese/flying-pages */
function flyingPages(){const a=new Set,b=new Set;var c={maxRPS:+pprh_fp_data.maxRPS,delay:+pprh_fp_data.delay,hoverDelay:+pprh_fp_data.hoverDelay,ignoreKeywords:pprh_fp_data.ignoreKeywords.replace(/\s/g,"").split(",")};const d=document.createElement("link"),e=d.relList&&d.relList.supports&&d.relList.supports("prefetch")&&window.IntersectionObserver&&"isIntersecting"in IntersectionObserverEntry.prototype,f=navigator.connection&&(navigator.connection.saveData||(navigator.connection.effectiveType||"").includes("2g"));if(f||!e)return;const g=a=>new Promise((b,c)=>{const d=document.createElement("link");d.rel="prefetch",d.href=a,d.onload=b,d.onerror=c,document.head.appendChild(d)}),h=a=>{const b=setTimeout(()=>p(),5e3);g(a).catch(()=>p()).finally(()=>clearTimeout(b))},i=(d,e=!1)=>{if(!(b.has(d)||a.has(d))){const g=window.location.origin;if(d.substring(0,g.length)===g&&window.location.href!==d){for(let a=0;a<c.ignoreKeywords.length;a++){var f=c.ignoreKeywords[a];if(0<f.length&&d.includes(f))return}e?(h(d),b.add(d)):a.add(d)}}},j=new IntersectionObserver(a=>{a.forEach(a=>{if(a.isIntersecting){const b=a.target.href;i(b,!c.maxRPS)}})});let k=null;const l=a=>{const d=a.target.closest("a");d&&d.href&&!b.has(d.href)&&(k=setTimeout(()=>{i(d.href,!0)},c.hoverDelay))},m=a=>{const c=a.target.closest("a");c&&c.href&&!b.has(c.href)&&i(c.href,!0)},n=a=>{const c=a.target.closest("a");c&&c.href&&!b.has(c.href)&&clearTimeout(k)},o=window.requestIdleCallback||function(a){const b=Date.now();return setTimeout(function(){a({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(Date.now()-b))}})},1)},p=()=>{document.querySelectorAll("a").forEach(a=>j.unobserve(a)),a.clear(),document.removeEventListener("mouseover",l,!0),document.removeEventListener("mouseout",n,!0),document.removeEventListener("touchstart",m,!0)};(()=>setInterval(()=>{Array.from(a).slice(0,c.maxRPS).forEach(c=>{h(c),b.add(c),a.delete(c)})},1e3))(),o(()=>setTimeout(()=>document.querySelectorAll("a").forEach(a=>j.observe(a)),1e3*c.delay));const q={capture:!0,passive:!0};document.addEventListener("mouseover",l,q),document.addEventListener("mouseout",n,q),document.addEventListener("touchstart",m,q)}flyingPages();