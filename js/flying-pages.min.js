/* Flying Pages | (c) gijo-varghese https://github.com/gijo-varghese/flying-pages */
function flyingPages(){const o=new Set,a=new Set,e=document.createElement("link");var t=e.relList&&e.relList.supports&&e.relList.supports("prefetch")&&window.IntersectionObserver&&"isIntersecting"in IntersectionObserverEntry.prototype,s={maxRPS:Number(pprh_fp_data.maxRPS),delay:Number(pprh_fp_data.delay),hoverDelay:Number(pprh_fp_data.hoverDelay),ignoreKeywords:pprh_fp_data.ignoreKeywords.replace(/\s/g,"").split(","),testing:"true"===pprh_fp_data.testing,maxPrefetches:Number(pprh_fp_data.maxPrefetches)},i=0;if(!(navigator.connection&&(navigator.connection.saveData||(navigator.connection.effectiveType||"").includes("2g")))&&t){var c=e=>{var n,t=setTimeout(()=>m(),5e3);n=e,new Promise((e,t)=>{const r=document.createElement("link");r.rel="prefetch",r.href=n,r.onload=e,r.onerror=t,document.head.appendChild(r),s.testing&&console.log(r)}).catch(()=>m()).finally(()=>clearTimeout(t))},n=(t,e)=>{var r=window.location.origin;if(!(a.has(t)||o.has(t)||s.maxPrefetches<=i&&!e||t.substring(0,r.length)!==r||window.location.href===t)){for(let e=0;e<s.ignoreKeywords.length;e++){var n=s.ignoreKeywords[e];if(0<n.length&&t.includes(n))return;if(n.indexOf("*")===n.length-1){n=n.replace("*","");if(0<=t.indexOf(n))return}}e?(c(t),a.add(t)):o.add(t),i++}};const f=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&(e=e.target.href,n(e,!s.maxRPS))})});let r=null;var d=e=>{var t=e.target.closest("a");t&&t.href&&!a.has(t.href)&&(r=setTimeout(()=>{n(t.href,!0)},s.hoverDelay))},l=e=>{e=e.target.closest("a");e&&e.href&&!a.has(e.href)&&n(e.href,!0)},u=e=>{e=e.target.closest("a");e&&e.href&&!a.has(e.href)&&clearTimeout(r)};const h=window.requestIdleCallback||function(e){var t=Date.now();return setTimeout(function(){e({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(Date.now()-t))}})},1)},m=()=>{document.querySelectorAll("a").forEach(e=>f.unobserve(e)),o.clear(),document.removeEventListener("mouseover",d,!0),document.removeEventListener("mouseout",u,!0),document.removeEventListener("touchstart",l,!0)};setInterval(()=>{Array.from(o).slice(0,s.maxRPS).forEach(e=>{c(e),a.add(e),o.delete(e)})},1e3),h(()=>setTimeout(()=>document.querySelectorAll("a").forEach(e=>f.observe(e)),1e3*s.delay));t={capture:!0,passive:!0};document.addEventListener("mouseover",d,t),document.addEventListener("mouseout",u,t),document.addEventListener("touchstart",l,t)}}flyingPages();