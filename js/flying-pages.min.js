/* Flying Pages | (c) gijo-varghese https://github.com/gijo-varghese/flying-pages */
function flyingPages(){const e=new Set,t=new Set;var r={maxRPS:Number(pprh_fp_data.maxRPS),delay:Number(pprh_fp_data.delay),hoverDelay:Number(pprh_fp_data.hoverDelay),ignoreKeywords:pprh_fp_data.ignoreKeywords.replace(/\s/g,"").split(","),debug:"true"===pprh_fp_data.debug};const n=document.createElement("link"),o=n.relList&&n.relList.supports&&n.relList.supports("prefetch")&&window.IntersectionObserver&&"isIntersecting"in IntersectionObserverEntry.prototype;if(navigator.connection&&(navigator.connection.saveData||(navigator.connection.effectiveType||"").includes("2g"))||!o)return;const a=e=>{const t=setTimeout(()=>h(),5e3);(e=>new Promise((t,r)=>{const n=document.createElement("link");n.rel="prefetch",n.href=e,n.onload=t,n.onerror=r,document.head.appendChild(n)}))(e).catch(()=>h()).finally(()=>clearTimeout(t))},s=(n,o=!1)=>{if(t.has(n)||e.has(n))return;const s=window.location.origin;if(n.substring(0,s.length)===s&&window.location.href!==n){for(let e=0;e<r.ignoreKeywords.length;e++){var i=r.ignoreKeywords[e];if(i.length>0&&n.includes(i))return;if(i.indexOf("*")===i.length-1){let e=i.replace("*","");if(n.indexOf(e)>0)return}}o?(a(n),t.add(n)):e.add(n)}},i=new IntersectionObserver(e=>{e.forEach(e=>{if(e.isIntersecting){const t=e.target.href;s(t,!r.maxRPS)}})});let c=null;const l=e=>{const n=e.target.closest("a");n&&n.href&&!t.has(n.href)&&(c=setTimeout(()=>{s(n.href,!0)},r.hoverDelay))},d=e=>{const r=e.target.closest("a");r&&r.href&&!t.has(r.href)&&s(r.href,!0)},u=e=>{const r=e.target.closest("a");r&&r.href&&!t.has(r.href)&&clearTimeout(c)},f=window.requestIdleCallback||function(e){const t=Date.now();return setTimeout(function(){e({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(Date.now()-t))}})},1)},h=()=>{document.querySelectorAll("a").forEach(e=>i.unobserve(e)),e.clear(),document.removeEventListener("mouseover",l,!0),document.removeEventListener("mouseout",u,!0),document.removeEventListener("touchstart",d,!0)};(()=>setInterval(()=>{Array.from(e).slice(0,r.maxRPS).forEach(r=>{a(r),t.add(r),e.delete(r)})},1e3))(),f(()=>setTimeout(()=>document.querySelectorAll("a").forEach(e=>i.observe(e)),1e3*r.delay));const m={capture:!0,passive:!0};document.addEventListener("mouseover",l,m),document.addEventListener("mouseout",u,m),document.addEventListener("touchstart",d,m)}flyingPages();