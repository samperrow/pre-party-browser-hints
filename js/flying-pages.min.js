/* Flying Pages | (c) gijo-varghese https://github.com/gijo-varghese/flying-pages */
!function(e,t){e.pprhFlyingPages=function(){const e=new Set,t=new Set,n=document.createElement("link"),r=n.relList&&n.relList.supports&&n.relList.supports("prefetch")&&window.IntersectionObserver&&"isIntersecting"in IntersectionObserverEntry.prototype,o=navigator.connection&&(navigator.connection.saveData||(navigator.connection.effectiveType||"").includes("2g"));var s,i=0;let a=null;const c=e=>{const t=setTimeout(()=>p(),5e3);(e=>new Promise((t,n)=>{const r=document.createElement("link");r.rel="prefetch",r.href=e,r.onload=t,r.onerror=n,document.head.appendChild(r),s.testing&&console.log(r)}))(e).catch(()=>p()).finally(()=>clearTimeout(t))};const l=(n,r=!1)=>{if(!function(n){const r=window.location.origin,o=r+document.location.pathname;return!(t.has(n)||e.has(n)||i>=s.maxPrefetches||n.substring(0,r.length)!==r||o===n)}(n))return!1;for(let e=0;e<s.ignoreKeywords.length;e++){let t=s.ignoreKeywords[e];if(t.length>0&&n.includes(t))return!1;if(t.endsWith("*")){let e=t.split("*")[0];if(n.indexOf(e)>=0){let t=n.split(e)[1];if(""!==t)return!1}}}return r?(c(n),t.add(n)):e.add(n),i++,!0},u=new IntersectionObserver(e=>{e.forEach(e=>{if(e.isIntersecting){const t=e.target.href;l(t,!s.maxRPS)}})}),d=()=>setInterval(()=>{Array.from(e).slice(0,s.maxRPS).forEach(n=>{c(n),t.add(n),e.delete(n)})},1e3),m=e=>{const n=e.target.closest("a");n&&n.href&&!t.has(n.href)&&(a=setTimeout(()=>{l(n.href,!0)},s.hoverDelay))},h=e=>{const n=e.target.closest("a");n&&n.href&&!t.has(n.href)&&l(n.href,!0)},f=e=>{const n=e.target.closest("a");n&&n.href&&!t.has(n.href)&&clearTimeout(a)},g=window.requestIdleCallback||function(e){const t=Date.now();return setTimeout(function(){e({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(Date.now()-t))}})},1)},p=()=>{document.querySelectorAll("a").forEach(e=>u.unobserve(e)),e.clear(),document.removeEventListener("mouseover",m,!0),document.removeEventListener("mouseout",f,!0),document.removeEventListener("touchstart",h,!0)},v={capture:!0,passive:!0};return document.addEventListener("mouseover",m,v),document.addEventListener("mouseout",f,v),document.addEventListener("touchstart",h,v),{AddUrlToQueue:l,Init:function(e){let t;void 0===e&&(e={maxRPS:3,delay:0,hoverDelay:50,ignoreKeywords:[],maxPrefetches:10,testing:!1}),Array.isArray(e.ignoreKeywords)&&(t=e.ignoreKeywords.map(e=>e.replace(/[\s|\\'<>^\\"]/g,""))),((s={maxRPS:Number(e.maxRPS),delay:Number(e.delay),hoverDelay:Number(e.hoverDelay),ignoreKeywords:t,testing:"true"===e.testing,maxPrefetches:Number(e.maxPrefetches)}).testing||!o&&r)&&(d(),g(()=>setTimeout(()=>document.querySelectorAll("a").forEach(e=>u.observe(e)),1e3*s.delay)))}}}()}(this),"object"==typeof module?module.exports=this.pprhFlyingPages:pprhFlyingPages.Init(pprh_fp_data);